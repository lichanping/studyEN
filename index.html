<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­£å¼è¯¾</title>
    <!-- Include SweetAlert2 CSS and JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="index.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <link rel="icon" type="image/png" href="sounds/icon.jpg">
    <!-- Add script to check login status -->
    <script type="module">
        import * as commonFunctions from './commonFunctions.js';
        commonFunctions.checkLoginStatus();
    </script>
    <script>
        const docxScript = document.createElement('script');
        docxScript.src = "https://unpkg.com/docx@7.7.0/build/index.js";
        docxScript.onload = () => {
            window.docx = docx;
            console.log("âœ… docx available?", window.docx);
            const docxLoadedEvent = new Event('docxLoaded');
            window.dispatchEvent(docxLoadedEvent);
        };
        docxScript.onerror = () => {
            console.error("âŒ Failed to load docx library");
        };
        document.head.appendChild(docxScript);
    </script>
</head>
<body>

<h1>æ­£å¼è¯¾ï¼ˆè¯æ±‡ï¼‰</h1>

<!-- é¡¶éƒ¨å›ºå®šï¼šç”¨æˆ·é€‰æ‹© -->
<div class="form-group fixed-display">
    <label for="userName">å­¦å‘˜:</label>
    <select id="userName"></select>
    <button id="noReviewTodayButton">ä»Šæ—¥æ— å¤ä¹ </button>
    <label id="reviewDateLabel"></label>
</div>

<!-- å¯¼èˆªæŒ‰é’® -->
<div id="button-container">
    <button id="navigateToTiyanClass">ä½“éªŒè¯¾</button>
    <button id="navigateToReadClass">é˜…è¯»è¯¾</button>
    <button id="wordSelfCheckButton">å•è¯è‡ªæ£€</button>
</div>

<!-- è¯¾ç¨‹ä¿¡æ¯åŒº -->
<fieldset class="section-group">
    <legend>ğŸ“š è¯¾ç¨‹ä¿¡æ¯</legend>
    <div class="scheduleLabels"></div>
    <div>
        <label id="courseLabel"></label>
        <label id="courseWordCountLabel"></label>
    </div>
    <div class="form-row">
        <label for="teacherName">æ•™å¸ˆ:</label>
        <select id="teacherName">
            <option value="liTeacher">è‹±è¯­æå‡ææ•™ç»ƒ</option>
            <option value="shiTeacher">è‹±è¯­æå‡æ–½æ•™ç»ƒ</option>
        </select>
        <button id="groupGreetingButton">å…¥ç¾¤æ‹›å‘¼è¯­</button>
        <button id="viewTotalHoursButton">æŸ¥çœ‹è¯¾æ—¶æ•°</button>
        <label for="classDuration">æ—¶é•¿:</label>
        <select id="classDuration">
            <option value="1">1å°æ—¶</option>
            <option value="0.5">0.5å°æ—¶</option>
        </select>
    </div>
    <div class="form-row">
        <label for="classDateTime">æ–°è¯¾æ—¶é—´:</label>
        <input type="datetime-local" id="classDateTime" value="">
    </div>
    <div class="form-row">
        <label for="reviewTime">å¤ä¹ æ—¶é—´:</label>
        <input type="datetime-local" id="reviewTime" value="2024-02-28T18:00">
    </div>
    <div class="form-row">
        <button id="scheduleNotificationButton">æ’è¯¾é€šçŸ¥</button>
        <button id="managementGroupTemplateButton">æŠ—é—å¿˜é€šçŸ¥</button>
        <button id="appointmentSchedulingButton">é¢„çº¦æ’è¯¾</button>
        <button id="openingSpeechButton">å¼€åœºè¯æœ¯</button>
        <button id="stop">ç»“æŸè¯­</button>
        <button id="lateMeetingReminderButton">è¿Ÿåˆ°10åˆ†é’Ÿå</button>
    </div>
    <div class="form-row">
        <label id="todayReviewDates"></label>
    </div>
</fieldset>

<!-- è¯¾å ‚åé¦ˆåŒº -->
<fieldset class="section-group">
    <legend>ğŸ“ è¯¾å ‚åé¦ˆ</legend>
    <div class="form-row">
        <label for="preTestWord">å­¦å‰æ£€æµ‹:</label>
        <input type="text" id="preTestWord" value="0">
        <label for="reviewWord">å¤ä¹ å•è¯:</label>
        <input type="text" id="reviewWord" placeholder="0" value="0">
        <label for="reviewforgetWord">å¤ä¹ é—å¿˜:</label>
        <input type="text" id="reviewforgetWord" value="0">
    </div>
    <div class="form-row">
        <label for="newWord">æ–°å­¦å•è¯:</label>
        <input type="text" id="newWord" placeholder="30" value="30">
        <label for="forgetWord">é—å¿˜:</label>
        <input type="text" id="forgetWord" value="0">
        <label for="learnedWord">å·²å­¦å•è¯:</label>
        <input type="text" id="learnedWord" value="0">
    </div>
    <div class="form-row">
        <button id="classFeedbackButton">è¯¾å ‚åé¦ˆ</button>
        <button id="selfReview">è¯¾åå¤ä¹ æ–¹å¼</button>
        <button id="bye">ä½“éªŒè¯¾ç»“æŸè¯­</button>
    </div>
    <div>
        <label for="newLearnedWords">æ–°å­¦å•è¯ (è‹±æ–‡+ä¸­æ–‡):<span style="color: red;">æ”¯æŒå³é”®ç²˜è´´</span></label>
        <br>
        <textarea id="newLearnedWords"></textarea>
    </div>
</fieldset>

<!-- æŠ—é—å¿˜å¤ä¹ åŒº -->
<fieldset class="section-group">
    <legend>ğŸ”„ æŠ—é—å¿˜å¤ä¹ </legend>
    <div class="form-row">
        <label>å¤ä¹ å•è¯:</label>
        <input type="text" class="antiForgettingReviewWord" value="">
        <input type="text" class="antiForgettingReviewWord" value="">
        <input type="text" class="antiForgettingReviewWord" value="">
        <input type="text" class="antiForgettingReviewWord" value="">
        <label>é—å¿˜:</label>
        <input type="text" id="antiForgettingForgetWord" value="0">
    </div>
    <div>
        <label for="forgetWords">é—å¿˜è¯ (è‹±æ–‡+ä¸­æ–‡):<span style="color: red;">æ”¯æŒå³é”®ç²˜è´´</span></label>
        <br>
        <textarea id="forgetWords"></textarea>
    </div>
    <div>
        <label for="pronounceWords">å‘éŸ³ä¸æ ‡å‡†çš„è¯:<span style="color: red;">æ”¯æŒå³é”®ç²˜è´´</span></label>
        <br>
        <textarea id="pronounceWords"></textarea>
    </div>
    <div>
        <label for="keyLanguagePoints">é‡ç‚¹è¯­è¨€ç‚¹:</label>
        <br>
        <textarea id="keyLanguagePoints" name="keyLanguagePoints"></textarea>
    </div>
    <div>
        <label for="practiceArea">è¯­è¨€ç‚¹å®æˆ˜åŒº:</label>
        <br>
        <textarea id="practiceArea" name="practiceArea"></textarea>
    </div>
    <div class="form-row">
        <button id="antiForgettingFeedbackButton">æŠ—é—å¿˜è¯¾å ‚åé¦ˆ</button>
        <button id="newFeedbackButton">æ–°ç‰ˆåé¦ˆ</button>
    </div>
</fieldset>

<!-- æ•°æ®ç»Ÿè®¡åŒº -->
<fieldset class="section-group">
    <legend>ğŸ“Š æ•°æ®ç»Ÿè®¡</legend>
    <div class="form-row">
        <input id="daysRangeInput" value="1" style="width:30px;">
        <span>å¤©</span>
        <button id="downloadFileButton">æŠ—é—å¿˜ç»Ÿè®¡</button>
        <button id="downloadFormalButton">æ­£è¯¾ç»Ÿè®¡</button>
        <button id="downloadSalaryButton">å·¥èµ„ç»Ÿè®¡</button>
    </div>
    <div class="form-row">
        <button id="downloadWordButton">å¯¼å‡ºWord</button>
        <button id="downloadForgetWordButton">å¯¼å‡ºé—å¿˜Word</button>
    </div>
</fieldset>

<!-- è¯¾æ—¶ç®¡ç†åŒº -->
<fieldset class="section-group bottom-controls">
    <legend>â° è¯¾æ—¶ç®¡ç†</legend>
    <div class="form-row">
        <label for="totalHours">æ€»è¯¾æ—¶:</label>
        <input type="text" id="totalHours" placeholder="è¯·è¾“å…¥æ€»è¯¾æ—¶">
        <button id="resetTotalButton">Resetæ€»è¯¾æ—¶</button>
        <button id="useHoursButton">æ‰£å‡è¯¾æ—¶</button>
        <input type="checkbox" id="includeHoursInfo">
        <label for="includeHoursInfo">æ˜¾ç¤ºè¯¾æ—¶è¯¦æƒ…</label>
    </div>
</fieldset>

<script type="module">
    import * as script from './classFormal.js';
    import * as commonFunctions from './commonFunctions.js';

    // ç›‘å¬ docxLoaded äº‹ä»¶
    window.addEventListener('docxLoaded', () => {
        const downloadWordButton = document.getElementById("downloadWordButton");
        downloadWordButton.addEventListener("click", script.generateWordReport);
        console.log("generateWordReport method is bound to the downloadWordButton");

        const downloadForgetWordButton = document.getElementById("downloadForgetWordButton");
        downloadForgetWordButton.addEventListener("click", script.generateForgetWordsReport);
        console.log("generateForgetWordReport method is bound to the downloadForgetWordButton");
    });
    document.getElementById("navigateToTiyanClass").addEventListener("click", commonFunctions.navigateToTiyanClass);
    document.getElementById("navigateToReadClass").addEventListener("click", commonFunctions.navigateToReadClass);
    document.getElementById("wordSelfCheckButton").addEventListener('click', commonFunctions.navigateToLearnWords);
    document.getElementById("userName").addEventListener("change", script.updateLabel);
    document.getElementById("groupGreetingButton").addEventListener("click", commonFunctions.handleGroupGreetingClick);
    document.getElementById("viewTotalHoursButton").addEventListener("click", script.viewTotalHoursClick);
    document.getElementById("noReviewTodayButton").addEventListener("click", commonFunctions.handleReviewLateReminderClick);
    document.getElementById("scheduleNotificationButton").addEventListener("click", script.handleScheduleNotificationClick);
    document.getElementById("stop").addEventListener("click", script.handleStopNotificationClick);
    document.getElementById("lateMeetingReminderButton").addEventListener("click", script.handleLateMeetingReminderClick);
    document.getElementById("classFeedbackButton").addEventListener("click", script.handleClassFeedbackClick);
    document.getElementById("appointmentSchedulingButton").addEventListener("click", () => {
        commonFunctions.handleAppointmentSchedulingClick({classType: 'å•è¯è¯¾'});
    });
    document.getElementById("selfReview").addEventListener("click", commonFunctions.selfReviewClick);
    document.getElementById("openingSpeechButton").addEventListener("click", commonFunctions.handleOpeningSpeechClick);
    document.getElementById("managementGroupTemplateButton").addEventListener("click", commonFunctions.handleManagementGroupTemplateClick);
    document.getElementById("antiForgettingFeedbackButton").addEventListener("click", commonFunctions.handleAntiForgettingFeedbackClick);
    document.getElementById("newFeedbackButton").addEventListener("click", commonFunctions.handleNewVersionFeedbackClick);
    document.getElementById("downloadFileButton").addEventListener("click", commonFunctions.downloadFeedbackFile);
    document.getElementById("downloadFormalButton").addEventListener("click", script.generateReport);
    document.getElementById("bye").addEventListener("click", commonFunctions.byeClick);
    document.getElementById("teacherName").addEventListener("change", script.updateUserNameOptions);
    document.getElementById("downloadSalaryButton").addEventListener("click", script.generateSalaryReport);
    document.getElementById("resetTotalButton").addEventListener("click", script.resetTotalButton);

    const forgetWordsTextarea = document.getElementById('forgetWords');
    const pronounceWordsTextarea = document.getElementById('pronounceWords');
    const newLearnedWordsTextarea = document.getElementById('newLearnedWords');
    const keyLanguagePoints = document.getElementById('keyLanguagePoints');
    const practiceArea = document.getElementById('practiceArea');

    commonFunctions.addRightClickPasteEvent(forgetWordsTextarea);
    commonFunctions.addRightClickPasteEvent(pronounceWordsTextarea);
    commonFunctions.addRightClickPasteEvent(newLearnedWordsTextarea);
    commonFunctions.addRightClickPasteEvent(keyLanguagePoints);
    commonFunctions.addRightClickPasteEvent(practiceArea);
</script>
</body>
</html>
